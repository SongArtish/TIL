# Wallet

---

[TOC]

---



## 지갑

블록체인 지갑은 블록체인에서 실행되고, 개인 키와 공개 키를 저장하고, 해당 키와 관련된 모든 트랜잭션을 블록체인에 모니터링하고 유지하는 소프트웨어이다. 즉, 비트코인, 이더리움 등의 암호화폐를 보관할 수 있는 계정을 뜻한다. 채굴(Mining)과 노드(Node)에서 노드가 바로, 지갑(Wallet)이다.

지갑의 **종류**는 다음과 같다.

- 데스크탑(PC) 지갑
- 모바일 지갑
- 하드웨어 지갑
- 웹 지갑

지갑의 **구조**는 다음과 같다.

- **주소(Public Key, 공개키)**: 다른 사람들이 암호화폐를 송금할 수 있도록 공개해도 됨
- **암호(Private Key, 개인키)**: 오직 소유자 본인만 알고 있어야 함



## 비트코인의 UTXO

UTXO(Unspent Transaction Outpus)는 미사용 트랜잭션 출력값(미지출 거래 출력)을 뜻한다. 비트코인은 계정이나 잔고가 없고, 블록체인에 기록된 **소비되지 않은 출력 값**을 통해 거래의 유효성을 검사하여 코인의 존재 여부를 확인한다. 따라서 비트코인에서는 코인이 지갑(wallet)에 저장되지 않고 UTXO에 저장된다고 보면 된다.

**장점**

- **이중 지불 방지**: 트랜잭션을 발생시키면 해당 UTXO는 검증을 받은 후 TX Pool에 들어간다. 그러므로 이중지불이 발생하면 채굴자들은 Pool에서 UTXO 검사 후 사용 기록이 있다면 해당 거래를 무효화할 수 있다.
- **잔고의 증명**: 추적하기가 용이하여, 거래에 대한 유효성을 검증하기가 매우 쉽다.

**단점**

- UTXO가 너무 과하게 생성될 경우: 잔고 조회 시 흩어져 있는 UTXO를 모두 모아야 되기 때문에, 소액 결제를 자주하거나, 채굴로 이자를 받게 되면 과도한 UTXO로 인해서 불필요한 수수료를 내야할 수 있다.



## 이더리움의 Account

이더리움 주소(address)와 개인키(private key)의 조합(쌍)을 어카운트(account)라고 한다. 이더리움 블록체인에서 주소와 키는 이더리움의 소유권과 전송을 나타내는데 주로 사용되며, 이더리움 계정은 이더 잔고를 보유하고 트랜잭션을 전송할 수 있다.

- **주소(Address)**: 이더리움 블록체인에서 사용자의 신분증에 해당한다.
- **키(Key)**: 개인키와 공개키로 구분되어 사용된다.
  - **개인키(Private Key)**: 무작위로 생성되며 비밀 키로써 유지해야 한다.
  - **공개키(Public Key)**: 개인키를 연산하여 생성되며 계정을 식별하는 요소로 사용된다.

**장점**

- **단순성(Simplicity)**: 직관적인 모델
- **효율성(Efficiency)**: 전송 계정이 거래 비용을 지불하기에 충분학 잔액을 가지고 있는지 확인하기만 하면 되므로 효율적

**단점**

- **이중 지불**: 이중 지불 공격에 노출되지만, nonce를 통해 대응하고 있음

### 주소 생성 과정

1. 개인키를 생성하고, 개인키로부터 공개키를 생성한다.
2. Keccak-256 알고리즘으로 공개키의 해시값을 계산한다.
3. 생성된 해시값의 뒤쪽 20byte만 남기고 제외 후 이더리움 주소를 생성한다.

### 계정 유형

1. **외부 소유 계정(EOA)**: 공개 주소와 개인키의 조합이다. 외부 소유 계정, 또는 외부 계정을 사용하면 다른 계정과 이더를 송수신하고 스마트 컨트랙트에 트랜잭션을 보낼 수 있다.
2. **컨트랙트 계정(CA)**: 상응하는 개인키가 없으며, 스마트 계약을 블록체인에 배포할 때 생성된다. 컨트랙트(혹은 컨트랙트 계정)는 다른 계정과 이더를 송수신하고, 관련된 코드를 담고(EOA와 다름), EOA나 다른 컨트랙트의 호출을 받아 트랜잭션을 발생시키는 기능을 가지고 있다.



## 지갑 종류

### 핫 월렛 & 콜드 월렛

암호화폐 지갑은 **인터넷 연결 유무**에 따라 크게 핫 월렛과 콜드 월렛으로 구분할 수 있다.

- 핫 월렛: 온라인
- 콜드 월렛: 오프라인

핫 월렛 콜드 월렛은 각각의 장단점을 비교하여 선택하면 된다. 일반적으로 거래소에서는 전체 자산의 70%는 콜드 월렛에 안전하게 보관하며, 30%를 핫 월렛에 보관한다.

#### 핫 월렛

핫월렛(Hot Wallet) 또는 온라인 지갑은 인터넷 주소가 네트워크에 연결되어 있어 온라인 상태에서 실시간으로 거래 정보를 주고받을 수 있다는 장점이 있다. 하지만, 개인키가 온라인에 노출되기에 해킹 등 보안 문제에 취약하다는 단점도 있다.

대표적으로 웹 월렛, 데스크탑 월렛, 모바일 월렛이 있다. 이더리움 플러그인인 메타마스크(MetaMask), 클레이튼의 카이카스(Kaikas), 클립(Klip)이 핫 월렛의 일종이다.

#### 콜드 월렛

콜드 월렛(Cold Wallet) 또는 오프라인 지갑은 지갑의 개인 키를 오프라인에 보관하는 지갑으로, 보안 측면에서 안전하다는 장점이 있다. 하지만, 실시간 거래가 불가능해 불편하다는 단점도 있다. 대표적으로 페이퍼 월렛과 하드웨어 월렛이 있다.

##### 페이퍼 월렛

페이퍼 월렛(Paper Wallet)은 지갑 주소를 만들고 주소를 종이에 써서 보관하는 형식이다. 간단히 말해서 암호화폐의 개인 키를 종이에 인쇄한 것이다. 온라인 해킹 등에 의한 위협에서 상대적으로 안전하지만, 종이를 분실한 위험도 존재한다.

##### 하드웨어 월렛

하드웨어 월렛(Hardware Wallet)은 개인 키를 USB나 카드에 보관하는 방식이다. 하드웨어 지갑을 다른 장치에 연결한 다음, 사용자는 소프트웨어를 통해 자신의 잔고를 확인하거나 트랜잭션을 생성할 수 있다.

### 스마트 컨트랙트 월렛

일반적으로 이더리움에서는 사용자가 개인 키를 사용하는 EOA로 자신의 자산을 관리한다. EOA는 기능이 제한적이며 코드(스마트 컨트랙트)를 담을 수 없다.

> - **EOA(Externally Owned Account)**: 개인 키에 의해 통제되는 계정 정보. 사용자 계정.
> - **CA(Contract Accounts)**: 컨트랙트 코드에 의해 통제되는 계정 정보

반면, 스마트 컨트랜트 월렛은 스마트 컨트랙트를 이용하는 월렛이다. CA에 컨트랙트 코드를 이용해 누가 어떤 조건에서 자산에 접근할 수 있는지를 프로그래밍화 할 수 있으며, EOA 기반 월렛보다 더 높은 수준의 보안, 유연성, 편의성을 제공한다. 사용자는 스마트 컨트랙트 코드를 사용해 다음의 기능도 사용할 수 있다.

- 멀티 시그 트랜잭션
- 일일 송금 제한
- 긴급 계정 동결
- 안전한 계정 복구
- dApp과의 상호작용

**특징**

- **2단계 이증**: 인증 앱 및 기본 지갑 솔루션을 통해 추가 보안 기능 제공
- **ATM과 같은 인출 제한**: 트랜잭션 금액 제한 설정이 가능
- **화이트리스트 & 블랙리스트**: 사용자는 자신이 지정한 주소(화이트리스트)로만 전송할 수 있고, 차단한 주소(블랙리스트)에는 전송이 제한됨
- **사기 경보 및 긴급 잠금**: 장치 분실 혹은 도난의 경우 계정을 잠그거나 손상된 장치에서 계정에 대한 액세스를 비활성화 할 수 있다.

#### 웹 월렛

웹 기반으로 호스팅되는 지갑으로, 사용자가 계정을 생성하고 보관할 수 있다. 인터넷 브라우저를 통해 접속하는 지갑으로, 대부분 브라우저(크롬 등) 확장 프로그램이나 웹 사이트 형태로 제공된다. 항상 인터넷에 노출되어 있어 보안에 가장 취약하지만, 즉시 거래가 가능하기 때문에 가장 실용적이다.

#### 데스크탑(PC) 월렛

Windows, Mac 또는 Linux 같은 OS에 다운로드하여 작동할 수 있는 앱이다. 인터넷 접속 여부에 따라 핫 월렛 혹은 콜드 월렛으로 작동할 수 있다. 웹 월렛보다는 불편하지만, 필요시 인터넷에 연결하여 거래가 가능하기 때문에 하드웨어 월렛에 비해 실용적이다.

#### 모바일 월렛

데스크탑 & 웹 지갑의 모바일 형태로, 인터넷 접속 여부에 따랑 핫 월렛 혹은 콜드 월렛으로 작동할 수 있다. 스마트폰 앱으로 다운받아 사용할 수 있으며, 언제 어디서나 거래가 가능하기 때문에 편리하다.

#### 하드웨어 월렛

거래에 서명할 때 개인 키를 인터넷에 노출하지 않기 때문에 온라인 상태에서 자산에 액세스하는 가장 안전한 방법이다.

#### 멀티 시그 월렛

멀티 시그 월렛(Multi-Signature Wallet)은 멀티시그(Multi-Sig)를 통해서만 송금이 가능하다는 특징이 있다. 멀티 시그 월렛은 하나의 지갑에 N명의 사용자가 소유 권한을 가지고, 트랜잭션을 만들는 경우 N명 중 k명이 트랜잭션에 서명해야 한다.

기존 핫 월렛과 콜드 월렛은 하나의 개인 키가 노출될 경우 문제가 발생하는데, 이를 보완하기 위한 월렛으로, 일반 지갑에 비해 보안이 우수하다는 장점이 있다. 그러나 스마트 컨트랙트 상에서 구현되기 때문에 사용성이 부족하며, 컨트랙트 코드 오류로 문제가 발생할 수도 있다. 멀티 시그 월렛에는 ConsenSys, Gnosis, Argent, BitGo 등이 있다.

### 비결정적 월렛 & 결정적 월렛

#### 비결정적 월렛

매번 비밀 키를 무작위로 생성하는 방식의 지갑으로, 매 트랜잭션마다 새로운 주소를 위한 새로운 지갑 파일으 생성해야 한다.지갑 데이터 분실 시 스마트 컨트랙트에 접근할 수 없으며, 지갑 데이터를 자주 백업해야 한다는 관리 측면에서 불편함이 있다.

#### 결정적(시드) 월렛

이러한 비결정적 월렛의 불편함을 해결하는 방식의 지갑이 바로 결정적 월렛이다. 결정적 월렛은 하나의 시드에서 하나의 시드 키를 가지고 있으며, 이 시드 키는 비밀 키를 만들기 위한 난수인데, 이 난수를 **니모닉 코드 단어(Mnemonic Code Words)**라고 한다.

#### HD 월렛(결정적)

### 기타 월렛

#### 브레인 월렛

### 니모닉



***Copyright* © 2022 Song_Artish**