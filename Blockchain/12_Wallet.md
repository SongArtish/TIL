# Wallet

---

[TOC]

---



## 지갑

블록체인 지갑은 블록체인에서 실행되고, 개인 키와 공개 키를 저장하고, 해당 키와 관련된 모든 트랜잭션을 블록체인에 모니터링하고 유지하는 소프트웨어이다. 즉, 비트코인, 이더리움 등의 암호화폐를 보관할 수 있는 계정을 뜻한다. 채굴(Mining)과 노드(Node)에서 노드가 바로, 지갑(Wallet)이다.

지갑의 **종류**는 다음과 같다.

- 데스크탑(PC) 지갑
- 모바일 지갑
- 하드웨어 지갑
- 웹 지갑

지갑의 **구조**는 다음과 같다.

- **주소(Public Key, 공개키)**: 다른 사람들이 암호화폐를 송금할 수 있도록 공개해도 됨
- **암호(Private Key, 개인키)**: 오직 소유자 본인만 알고 있어야 함



## 비트코인의 UTXO

UTXO(Unspent Transaction Outpus)는 미사용 트랜잭션 출력값(미지출 거래 출력)을 뜻한다. 비트코인은 계정이나 잔고가 없고, 블록체인에 기록된 **소비되지 않은 출력 값**을 통해 거래의 유효성을 검사하여 코인의 존재 여부를 확인한다. 따라서 비트코인에서는 코인이 지갑(wallet)에 저장되지 않고 UTXO에 저장된다고 보면 된다.

**장점**

- **이중 지불 방지**: 트랜잭션을 발생시키면 해당 UTXO는 검증을 받은 후 TX Pool에 들어간다. 그러므로 이중지불이 발생하면 채굴자들은 Pool에서 UTXO 검사 후 사용 기록이 있다면 해당 거래를 무효화할 수 있다.
- **잔고의 증명**: 추적하기가 용이하여, 거래에 대한 유효성을 검증하기가 매우 쉽다.

**단점**

- UTXO가 너무 과하게 생성될 경우: 잔고 조회 시 흩어져 있는 UTXO를 모두 모아야 되기 때문에, 소액 결제를 자주하거나, 채굴로 이자를 받게 되면 과도한 UTXO로 인해서 불필요한 수수료를 내야할 수 있다.



## 이더리움의 Account

이더리움 주소(address)와 개인키(private key)의 조합(쌍)을 어카운트(account)라고 한다. 이더리움 블록체인에서 주소와 키는 이더리움의 소유권과 전송을 나타내는데 주로 사용되며, 이더리움 계정은 이더 잔고를 보유하고 트랜잭션을 전송할 수 있다.

- **주소(Address)**: 이더리움 블록체인에서 사용자의 신분증에 해당한다.
- **키(Key)**: 개인키와 공개키로 구분되어 사용된다.
  - **개인키(Private Key)**: 무작위로 생성되며 비밀 키로써 유지해야 한다.
  - **공개키(Public Key)**: 개인키를 연산하여 생성되며 계정을 식별하는 요소로 사용된다.

**장점**

- **단순성(Simplicity)**: 직관적인 모델
- **효율성(Efficiency)**: 전송 계정이 거래 비용을 지불하기에 충분학 잔액을 가지고 있는지 확인하기만 하면 되므로 효율적

**단점**

- **이중 지불**: 이중 지불 공격에 노출되지만, nonce를 통해 대응하고 있음

### 주소 생성 과정

1. 개인키를 생성하고, 개인키로부터 공개키를 생성한다.
2. Keccak-256 알고리즘으로 공개키의 해시값을 계산한다.
3. 생성된 해시값의 뒤쪽 20byte만 남기고 제외 후 이더리움 주소를 생성한다.

### 계정 유형

1. **외부 소유 계정(EOA)**: 공개 주소와 개인키의 조합이다. 외부 소유 계정, 또는 외부 계정을 사용하면 다른 계정과 이더를 송수신하고 스마트 컨트랙트에 트랜잭션을 보낼 수 있다.
2. **컨트랙트 계정(CA)**: 상응하는 개인키가 없으며, 스마트 계약을 블록체인에 배포할 때 생성된다. 컨트랙트(혹은 컨트랙트 계정)는 다른 계정과 이더를 송수신하고, 관련된 코드를 담고(EOA와 다름), EOA나 다른 컨트랙트의 호출을 받아 트랜잭션을 발생시키는 기능을 가지고 있다.



***Copyright* © 2022 Song_Artish**